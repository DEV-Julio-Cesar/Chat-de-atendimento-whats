<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Atendimento WhatsApp</title>
    <style>
        :root { --bg: #fff; --text:#333; --panel:#f8f9fa; --grad1:#667eea; --grad2:#764ba2; }
        [data-theme="dark"] { --bg:#0f1222; --text:#eaeaea; --panel:#1e2238; --grad1:#3b82f6; --grad2:#8b5cf6; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--grad1) 0%, var(--grad2) 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            background: var(--bg);
            color: var(--text);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,.3);
            max-width: 800px;
            width: 90%;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .menu-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 24px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform .2s, box-shadow .2s;
            text-align: center;
        }
        
        .menu-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, .4);
        }
        
        .menu-item .icon {
            font-size: 32px;
            margin-bottom: 8px;
            display: block;
        }
        
        .status-bar {
            background: var(--panel);
            padding: 16px;
            border-radius: 8px;
            font-size: 13px;
            color: #666;
            display:flex;
            gap:12px;
            align-items:center;
            justify-content:space-between;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .status-item:last-child {
            margin-bottom: 0;
        }
        
        .badge {
            background: #10b981;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸš€ Sistema de Atendimento WhatsApp</h1>
        <p class="subtitle">Gerencie suas conversas de forma profissional</p>
        
        <div class="menu-grid">
            <button class="menu-item" onclick="abrirNovoQR()">
                <span class="icon">ðŸ“±</span>
                Conectar WhatsApp
            </button>
            
            <button class="menu-item" onclick="abrirChat()">
                <span class="icon">ðŸ’¬</span>
                Abrir Chat
            </button>
            
            <button class="menu-item" onclick="abrirDashboard()">
                <span class="icon">ðŸ“Š</span>
                Dashboard
            </button>
            
            <button class="menu-item" onclick="abrirChatbot()">
                <span class="icon">ðŸ¤–</span>
                Configurar Bot
            </button>
            
            <button class="menu-item" onclick="abrirUsuarios()">
                <span class="icon">ðŸ‘¥</span>
                UsuÃ¡rios
            </button>
            
            <button class="menu-item" onclick="listarClientes()">
                <span class="icon">ðŸ“‹</span>
                Clientes
            </button>
        </div>
        
        <div class="status-bar">
          <div style="display:flex;gap:16px;align-items:center;">
            <div class="status-item"><span>Status do Sistema:</span> <span class="badge">Online</span></div>
            <div class="status-item"><span>Clientes Conectados:</span> <strong id="clientesConectados">0</strong></div>
            <div class="status-item"><span>Ãšltima AtualizaÃ§Ã£o:</span> <span id="ultimaAtualizacao">-</span></div>
          </div>
          <div>
            <select id="themeSel">
              <option value="light">Claro</option>
              <option value="dark">Escuro</option>
            </select>
          </div>
        </div>
    </div>

    <script>
        // Atualiza status
        async function atualizarStatus() {
            const clientes = await window.electronAPI.listarClientesConectados();
            document.getElementById('clientesConectados').textContent = clientes.length;
            document.getElementById('ultimaAtualizacao').textContent = 
                new Date().toLocaleTimeString();
        }

        async function abrirNovoQR() {
            await window.electronAPI.abrirNovaJanelaQR();
        }

        async function abrirChat() {
            const clientes = await window.electronAPI.listarClientesConectados();
            if (clientes.length === 0) {
                alert('âŒ Nenhum cliente WhatsApp conectado.\n\nConecte um cliente primeiro clicando em "Conectar WhatsApp".');
                return;
            }
            window.electronAPI.abrirChat(clientes[0]);
        }

        function abrirDashboard() {
            window.electronAPI.abrirDashboard();
        }

        function abrirChatbot() {
            window.electronAPI.abrirChatbot();
        }

        function abrirUsuarios() {
            window.electronAPI.abrirUsuarios();
        }

        async function listarClientes() {
            const clientes = await window.electronAPI.listarClientesConectados();
            if (clientes.length === 0) {
                alert('Nenhum cliente conectado');
                return;
            }
            alert(`Clientes conectados:\n\n${clientes.join('\n')}`);
        }

        // Cliente pronto
        window.electronAPI.aoClientePronto(() => {
            atualizarStatus();
        });

        // Atualiza a cada 5 segundos
        setInterval(atualizarStatus, 5000);
        
        // Inicial
        atualizarStatus();

        (async () => {
          const t = await window.electronAPI.getTheme();
          document.documentElement.setAttribute('data-theme', t.theme || 'light');
          document.getElementById('themeSel').value = t.theme || 'light';
        })();

        document.getElementById('themeSel').addEventListener('change', async (e) => {
          const theme = e.target.value;
          await window.electronAPI.setTheme(theme);
          document.documentElement.setAttribute('data-theme', theme);
        });
    </script>
</body>
</html>